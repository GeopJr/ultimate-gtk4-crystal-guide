import{_ as s,c as e,o as a,a as o}from"./app.4beb082a.js";const u=JSON.parse('{"title":"GResource","description":"","frontmatter":{},"headers":[],"relativePath":"en/concepts/gresource.md","lastUpdated":1657016119000}'),n={name:"en/concepts/gresource.md"},l=o(`<h1 id="gresource" tabindex="-1">GResource <a class="header-anchor" href="#gresource" aria-hidden="true">#</a></h1><p>GResource is a resource bundle that includes application data like:</p><ul><li>UI files</li><li>Icons</li><li>CSS</li></ul><p>There are quite a few ways to bundle such assets in Crystal (including manually loading them using macros), however GResource offers something important that they don&#39;t - being integrated with GTK.</p><p>That allows you to eg. directly set css &amp; icons to those loaded from the bundle (<code>Widget#icon_name = &quot;path/in/bundle/icon.svg&quot;</code>).</p><p>To get started, create a <code>data/APP_ID.gresource.xml</code> with the following content:</p><div class="language-xml"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">gresources</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">gresource</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">prefix</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/path/for/bundle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">file</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">compressed</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">css/style.css</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">file</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">file</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">compressed</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">preprocess</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xml-stripblanks</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">icons/my_app.svg</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">file</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">file</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">compressed</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">preprocess</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">xml-stripblanks</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">ui/my_app.ui</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">file</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">gresource</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">gresources</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>That will bundle the following files: <code>data/css/style.css</code>, <code>icons/my_app.svg</code> &amp; <code>ui/my_app.ui</code>, compress them and strip their whitespace.</p><p>You should replace <code>/path/for/bundle</code> with the path you want, usually the APP_ID (eg. <code>dev.geopjr.My_app</code> =&gt; <code>/dev/geopjr/My_app</code>).</p><p>And now you can load them as if they are at that location, eg: <code>Gtk::CssProvider#load_from_resource(&quot;/dev/geopjr/My_app/css/style.css&quot;)</code>.</p><p>Debugger should also be able to list them under <code>Global &gt; Resources</code>.</p><h4 id="creating-loading-the-binary" tabindex="-1">Creating &amp; Loading the binary <a class="header-anchor" href="#creating-loading-the-binary" aria-hidden="true">#</a></h4><p>You can either create and load it manually or use the <code>Gio#register_resource</code> macro that does both of them for you:</p><h5 id="gio-register-resource" tabindex="-1"><code>Gio#register_resource</code> <a class="header-anchor" href="#gio-register-resource" aria-hidden="true">#</a></h5><p>We just call it in <code>prerequisites</code>:</p><div class="language-crystal"><span class="copy"></span><pre><code><span class="line"><span style="color:#FFCB6B;">Gio</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">register_resource</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">data/dev.geopjr.My_app.gresource.xml</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">data</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h5 id="manually" tabindex="-1">Manually <a class="header-anchor" href="#manually" aria-hidden="true">#</a></h5><h6 id="creating-the-binary" tabindex="-1">Creating the binary <a class="header-anchor" href="#creating-the-binary" aria-hidden="true">#</a></h6><p>The binary is being created with the use of an external tool, <code>glib-compile-resources</code>.</p><p>The full command is:</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ glib-compile-resources --sourcedir BASE_FOLDER --target PATH/TO/COMPILED.gresource PATH/TO/FILE.gresource.xml</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>Having the above locations as examples, it should look like:</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ glib-compile-resources --sourcedir data --target data/dev.geopjr.My_app.gresource data/dev.geopjr.My_app.gresource.xml</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h6 id="loading-the-binary" tabindex="-1">Loading the binary <a class="header-anchor" href="#loading-the-binary" aria-hidden="true">#</a></h6><p>There should now be a <code>data/dev.geopjr.My_app.gresource</code> binary.</p><p>We load it in memory using macros and then register it in <code>prerequisites</code>. Follow <code>Gio#register_resource</code>&#39;s <a href="https://github.com/hugopl/gtk4.cr/blob/77c98c350166baedc44d10e2030aaf7946d04e6b/src/bindings/gio/resource.cr" target="_blank" rel="noopener noreferrer">source</a>.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Remember to add <code>*.gresource</code> to your <code>.gitignore</code></p></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Replace <code>APP_ID</code> with your app&#39;s ID</p></div>`,28),p=[l];function t(r,c,i,d,y,D){return a(),e("div",null,p)}var g=s(n,[["render",t]]);export{u as __pageData,g as default};
